---
# CIS 1.4 Compliance Checks - Boot Settings

- name: Check CIS 1.4.1 - Bootloader permissions
  stat:
    path: /boot/grub/grub.cfg
  register: grub_cfg

- name: Verify bootloader permissions
  shell: |
    PERMS=$(stat -c "%a" /boot/grub/grub.cfg)
    OWNER=$(stat -c "%U:%G" /boot/grub/grub.cfg)
    if [ "$PERMS" = "600" ] && [ "$OWNER" = "root:root" ]; then
      echo "PASS"
    else
      echo "FAIL"
    fi
  register: bootloader_check
  failed_when: false
  changed_when: false
  when: grub_cfg.stat.exists

