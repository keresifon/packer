---
# CIS 6.2 Compliance Checks - User and Group Settings (Level 2)

- name: Check CIS 6.2.1 - Password expiration configured (Level 2)
  shell: |
    if grep -q "^PASS_MAX_DAYS 365" /etc/login.defs || grep -q "^PASS_MAX_DAYS [0-9][0-9][0-9]$" /etc/login.defs; then
      echo "PASS"
    else
      echo "FAIL"
    fi
  register: pass_max_days_check
  failed_when: false
  changed_when: false
  when: (cis_level | default(cis_level_default) | int) >= 2

- name: Check CIS 6.2.2 - Minimum days between password changes (Level 2)
  shell: |
    if grep -q "^PASS_MIN_DAYS 7" /etc/login.defs || grep -q "^PASS_MIN_DAYS [0-9]$" /etc/login.defs; then
      echo "PASS"
    else
      echo "FAIL"
    fi
  register: pass_min_days_check
  failed_when: false
  changed_when: false
  when: (cis_level | default(cis_level_default) | int) >= 2

