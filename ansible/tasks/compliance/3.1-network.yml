---
# CIS 3.1 Compliance Checks - Network Parameters

- name: Check CIS 3.1.1 - IP forwarding disabled
  shell: |
    if [ "$(sysctl -n net.ipv4.ip_forward)" = "0" ]; then
      echo "PASS"
    else
      echo "FAIL"
    fi
  register: ip_forward_check
  failed_when: false
  changed_when: false

- name: Check CIS 3.3.9 - TCP SYN Cookies enabled
  shell: |
    if [ "$(sysctl -n net.ipv4.tcp_syncookies)" = "1" ]; then
      echo "PASS"
    else
      echo "FAIL"
    fi
  register: syn_cookies_check
  failed_when: false
  changed_when: false

