---
# CIS 1.5 Compliance Checks - Process Hardening

- name: Check CIS 1.5.1 - Core dumps restricted
  shell: |
    if grep -q "hard core" /etc/security/limits.conf && [ "$(sysctl -n fs.suid_dumpable)" = "0" ]; then
      echo "PASS"
    else
      echo "FAIL"
    fi
  register: coredump_check
  failed_when: false
  changed_when: false

- name: Check CIS 1.5.3 - ASLR enabled
  shell: |
    if [ "$(sysctl -n kernel.randomize_va_space)" = "2" ]; then
      echo "PASS"
    else
      echo "FAIL"
    fi
  register: aslr_check
  failed_when: false
  changed_when: false

